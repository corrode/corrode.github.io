<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    

    <title>Don&#x27;t Use Preludes And Globs | corrode Rust Consulting</title>
    <meta name="author" content="Corrode Rust Consulting">
    <meta name="description" content="Have you ever wondered why you don’t have to import std::result::Result before you can use it?
The reason is Rust’s &lt;a class=&quot;external-link&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;std&#x2F;prelude&#x2F;…">

    <!-- Open Graph tags -->
    <meta property="og:title" content="Don&#x27;t Use Preludes And Globs | corrode Rust Consulting">
    <meta property="og:description" content="Have you ever wondered why you don’t have to import std::result::Result before you can use it?
The reason is Rust’s &lt;a class=&quot;external-link&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;std&#x2F;prelude&#x2F;…">
    <meta property="og:image" content="https:&#x2F;&#x2F;corrode.dev&#x2F;blog&#x2F;dont-use-preludes-and-globs&#x2F;social.png">
    <meta property="og:url" content="https:&#x2F;&#x2F;corrode.dev&#x2F;blog&#x2F;dont-use-preludes-and-globs&#x2F;">
    <meta property="og:site_name" content="Corrode Rust Consulting">
    <meta property="og:type" content="website">
    <meta name="publish_date" property="og:publish_date" content="2024-07-29">

    <!-- Twitter Card tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Don&#x27;t Use Preludes And Globs | corrode Rust Consulting">
    <meta name="twitter:description" content="Have you ever wondered why you don’t have to import std::result::Result before you can use it?
The reason is Rust’s &lt;a class=&quot;external-link&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;std&#x2F;prelude&#x2F;…">
    <meta name="twitter:image" content="https:&#x2F;&#x2F;corrode.dev&#x2F;blog&#x2F;dont-use-preludes-and-globs&#x2F;social.png">

    <link rel="stylesheet" type="text/css" href="/syntax-theme-dark-custom.css" media="(prefers-color-scheme: dark)" />
    <link rel="stylesheet" type="text/css" href="/syntax-theme-light-custom.css" media="(prefers-color-scheme: light)" />
    <link rel="stylesheet" type="text/css" href="/style.css" />

    <link rel="me" href="https://mastodon.social/@mre">
    <link rel="alternate" type="application/rss+xml" title="corrode RSS feed" href="/rss.xml">

    <script type="module" src="https://oxitraffic-corrode-dev.mo8it.com/count.js"></script>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    
    <script src="/scripts/clipboard.js"></script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://corrode.dev/blog/dont-use-preludes-and-globs/"
      },
      "headline": "Don't Use Preludes And Globs",
      "description": "Have you ever wondered why you don’t have to import std::result::Result before you can use it?
The reason is Rust’s &lt;a class=&quot;external-link&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;std&#x2F;prelude&#x2F;…",
      
      "author": {
        "@type": "Person",
        "name": "Matthias Endler"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Corrode Consulting",
        "logo": {
          "@type": "ImageObject",
          "url": "https://corrode.dev/corrode.svg"
        }
      },
      "datePublished": "2024-07-29",
      
      "dateModified": "2024-08-07"
      
    }
    </script>

</head>
<body>
    <div class="app">
        <nav>
            <!-- Logo and Home Link -->
            <div>
                <a  class="nav-item" 
                    href="https://corrode.dev/">
                    <span class="logo">
                        
                        <svg xmlns="http://www.w3.org/2000/svg" width="200" height="85" viewBox="0 0 200 85.5"><path d="m165.192 18.534-6.6.03v20.6c-8.634-5.485-23.28-1.166-23.28 12.48 0 20.182 30.335 18.865 29.88-.01zM43.093 36.7c-8.148 0-14.96 5.716-14.96 14.79 0 8.599 6.367 14.801 14.96 14.801 8.464 0 14.92-6.2 14.92-14.79 0-8.791-6.591-14.801-14.92-14.801m72.5 0c-6.784 0-14.614 4.16-14.97 14.79 0 8.748 6.556 14.801 14.97 14.801 8.474 0 14.93-6.212 14.93-14.79 0-8.87-6.698-14.801-14.93-14.801m-41.054.002c-6.02.032-11.877 4.563-11.707 11.739v17.85l6.683-.022-.25-15.927c0-7.276 5.415-7.84 8.31-7.39l2.9-4.657a11.5 11.5 0 0 0-5.936-1.593m17.917 0c-6.019.032-11.877 4.563-11.707 11.739v17.85l6.683-.022-.25-15.927c0-7.276 5.415-7.84 8.311-7.39l2.9-4.657a11.5 11.5 0 0 0-5.937-1.593m-74.936.002c-7.362.053-14.377 5.52-14.377 14.945 0 14.417 15.027 17.221 22.82 12.59-1.16-1.52-2.078-3.198-2.891-4.92-5.261 2.648-13.32.717-13.32-7.87 0-8.528 8.048-10.399 13.21-7.84.52-1.397 2.136-4.165 3.07-5.04-2.279-1.243-4.835-1.892-8.512-1.865m166.727.126c-6.922.155-14.114 5.18-14.114 14.8 0 14.198 14.814 17.353 22.83 12.588l-2.88-4.929c-5.135 2.544-11.713.7-13.04-5.21l19.7-2.829c1.078-9.86-5.574-14.575-12.496-14.42m.998 5.736c2.797-.086 5.255 1.465 6.568 4.8l-14.49 1.994c.679-4.107 4.325-6.683 7.922-6.794m-141.653.024c2.716 0 8.31 1.41 8.31 8.98 0 5.313-3.079 8.92-8.31 8.92-5.172 0-8.32-3.526-8.32-8.92 0-8.535 6.885-8.98 8.32-8.98m72.5 0c2.716 0 8.31 1.41 8.31 8.98 0 5.295-3.056 8.92-8.31 8.92-5.242 0-8.32-3.629-8.32-8.92 0-8.535 6.885-8.98 8.32-8.98m34.505.03c4.157.034 8.316 3.11 8.316 9.125 0 12.024-16.63 12.05-16.63 0 0-6.152 4.156-9.16 8.314-9.126m2226.692-755.486h6.52c0-12.105-1.226-24.512 8.22-21.981l3.6-5.43c-20.776-6.381-18.34 15.492-18.34 27.41"/></svg>
                    </span>
                </a>
            </div>

            <input id="menu-toggle" type="checkbox" />
            <label class="menu-button-container" for="menu-toggle">
                <div class="menu-button"></div>
            </label>

            <!-- Menu Items -->
            <ul class="menu">
                <li>
                    <!-- Theme Toggle -->
                    <a href="javascript:toggleColorScheme();">
                        <span id="icon-moon">
                            
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"><path fill="#fff" d="M12 22c5.523 0 10-4.477 10-10 0-.463-.694-.54-.933-.143a6.5 6.5 0 1 1-8.924-8.924C12.54 2.693 12.463 2 12 2 6.477 2 2 6.477 2 12s4.477 10 10 10"/></svg>
                        </span>
                        <span id="icon-sun">
                            
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"><path fill="#000" d="M17 12a5 5 0 1 1-10 0 5 5 0 0 1 10 0"/><path fill="#000" fill-rule="evenodd" d="M12 1.25a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-1.5 0V2a.75.75 0 0 1 .75-.75M3.669 3.716a.75.75 0 0 1 1.06-.047L6.95 5.7a.75.75 0 1 1-1.012 1.107L3.716 4.776a.75.75 0 0 1-.047-1.06m16.662 0a.75.75 0 0 1-.047 1.06l-2.222 2.031A.75.75 0 0 1 17.05 5.7l2.222-2.031a.75.75 0 0 1 1.06.047M1.25 12a.75.75 0 0 1 .75-.75h2a.75.75 0 0 1 0 1.5H2a.75.75 0 0 1-.75-.75m18 0a.75.75 0 0 1 .75-.75h2a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1-.75-.75m-2.224 5.025a.75.75 0 0 1 1.06 0l2.222 2.223a.75.75 0 0 1-1.06 1.06l-2.222-2.222a.75.75 0 0 1 0-1.06m-10.051 0a.75.75 0 0 1 0 1.061l-2.223 2.222a.75.75 0 0 1-1.06-1.06l2.222-2.223a.75.75 0 0 1 1.06 0M12 19.25a.75.75 0 0 1 .75.75v2a.75.75 0 0 1-1.5 0v-2a.75.75 0 0 1 .75-.75" clip-rule="evenodd"/></svg>
                        </span>
                    </a>
                </li>
                <li>
                    <a  class="nav-item" 
                        href="https://corrode.dev/"><span>Home</span>
                    </a>
                </li>
                <li>
                    <a  class="nav-item" 
                        href="https://corrode.dev/learn">
                        <span>Learn</span>
                    </a>
                </li>
                <li>
                    <a  class="nav-item active" 
                        href="https://corrode.dev/blog">
                        <span>Blog</span>
                    </a>
                </li>
                <li>
                    <a  class="nav-item" 
                        href="https://corrode.dev/podcast">
                        <span>Podcast</span>
                    </a>
                </li>
                <li>
                    <a href="https://corrode.dev/services" class="cta-button">
                        <span>Consulting</span>
                    </a>
                </li>
            </ul>
        </nav>

        <main class="container">
            
<article>
  <div class="article-heading">
    <h2 class="subheading">
      <a href="https://corrode.dev/blog">Idiomatic Rust</a>
    </h2>
    <h1>Don&#x27;t Use Preludes And Globs</h1>
    <div class="article-date">
      <span class="icon-calendar"></span>
      <span>
        
          Last updated: 2024-08-07
        
      </span>
    </div>
    
  </div>
  <div class="article-content-wrapper">
    
    <div class="article-content">
    

      <p>Have you ever wondered why you don’t have to import <code>std::result::Result</code> before you can use it?</p>
<p>The reason is Rust’s <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://doc.rust-lang.org/std/prelude/index.html">prelude</a>, which re-exports a bunch of types that automatically get added to your program’s namespace.
A more correct definition is: <em>Preludes are collections of names automatically brought into scope in every module of a crate.</em></p>
<p>In fact, there are multiple preludes like
<a class="external-link" rel="noopener noreferrer" target="_blank" href="https://doc.rust-lang.org/std/prelude/v1/index.html"><code>std::prelude::v1</code></a>, <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://doc.rust-lang.org/std/prelude/rust_2015/index.html"><code>std::prelude::rust_2015</code></a>, and <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://doc.rust-lang.org/nightly/std/prelude/rust_2024/index.html"><code>std::prelude::rust_2024</code></a>, and more in the future.</p>
<p>It would be jarring to import those basic types over and over again so I’d say it’s a win to have a prelude for the standard library.</p>
<p>Maybe that’s the reason why popular libraries started to provide their own preludes: <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://docs.rs/rayon/latest/rayon/prelude/index.html">Rayon has one</a> and so do
<a class="external-link" rel="noopener noreferrer" target="_blank" href="https://docs.rs/pyo3/latest/pyo3/prelude/index.html">pyo3</a> and <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://docs.rs/bevy/latest/bevy/prelude/index.html">bevy</a> and
<a class="external-link" rel="noopener noreferrer" target="_blank" href="https://docs.rs/ratatui/latest/ratatui/prelude/index.html">ratatui</a>.</p>
<p>Some people consider preludes and glob imports<sup class="footnote-reference" id="fr-1-1"><a href="#fn-1">1</a></sup> to be antipatterns – I’m one of them. Let me explain why.</p>
<h2 id="i-don-t-like-preludes"><a class="zola-anchor" href="#i-don-t-like-preludes" aria-label="Anchor link for: i-don-t-like-preludes">I don’t like preludes</a></h2>
<p>Preludes help beginners start quickly and with zero boilerplate, but they also prevent users from understanding the full picture of a crate.
For larger projects, preludes can cause namespace pollution and naming conflicts.</p>
<p>I have a hard time reviewing code which uses preludes: looking up a definition might not work in my code review tool, and I’d have to manually track down where types came from.</p>
<p>Explicit imports bring clarity.</p>
<p>Speaking of which! A good compromise between convenience and clarity is to import whole modules instead of individual items, such as <code>use std::fmt</code>. Then you can say <code>fmt::Debug</code> instead of <code>std::fmt::Debug</code>. It’s a little easier on the eyes, but still provides clarity.</p>
<p>Unless you write a highly critical framework which uses well-established types, which are <em>absolutely positively always</em> mandatory in every (or at least most) interaction with your library, don’t add a prelude. Even then, make sure that prelude carries its own weight. <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://github.com/tokio-rs/tokio/issues/3257">Tokio removed their prelude because that wasn’t the case</a>.</p>
<p>An explicit import might not be that bad. In fact, it might even clear things up for your users, because it’s easier to see where imports come from.</p>
<p>If you’re worried about ergonomics, why not re-export common types in root? Then they can get imported with <code>use mycrate::SomeType;</code> instead of <code>use mycrate::mymodule::SomeType;</code>.</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Re-export a type in your lib.rs
</span></span><span class="z-source z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">mymodule<span class="z-punctuation z-accessor z-rust">::</span></span>SomeType<span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<p>On the same note, avoid glob imports (like <code>use prelude::*</code>
or <code>use mycrate::mymodule::*</code>).
The reasons are the same: they hide dependencies and make it harder to grep for usages of a type or function.</p>
<h2 id="common-arguments-for-preludes"><a class="zola-anchor" href="#common-arguments-for-preludes" aria-label="Anchor link for: common-arguments-for-preludes">Common Arguments for Preludes</a></h2>
<p>Let’s address some common arguments in favor of preludes and glob imports
and see if there’s a better way to achieve the same goal.</p>
<h3 id="preludes-in-examples"><a class="zola-anchor" href="#preludes-in-examples" aria-label="Anchor link for: preludes-in-examples">Preludes in examples</a></h3>
<p>Some people like to use preludes in their documentation examples.</p>
<p>This can be sweet when you quickly want to show how to use your library without too much boilerplate. But at what cost?</p>
<p>Users <em>can and will</em> start to copy-paste that prelude into their code, at which point you’ll have to support it. It’s convenient in the beginning, but can result in a maintenance burden in the long run.</p>
<p>One way to avoid that is to hide code lines for imports in your documentation examples. With that, examples are still easy to read, while users can’t copy-paste the imports:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span> # Examples
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span>
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span> ```
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span> # use mycrate::SomeType;
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span> # fn main() {
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span> let t = SomeType::new(); 
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span> # }
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-documentation z-rust"><span class="z-punctuation z-definition z-comment z-rust">//!</span> ```
</span></span></code></pre>
<p>This will render as:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> t <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-meta z-path z-rust">SomeType<span class="z-punctuation z-accessor z-rust">::</span></span>new<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<div class="info">
  
  <div class="info-header">
    
      <span class="icon icon-warning"></span>
    
    <h4><p>Caution When Hiding Code in Examples</p>
</h4>
  </div>
  
  <p>Be careful with this approach and don’t overdo it. Try to keep your examples simple and don’t hide too much code because it can be a frustrating experience for your users if they copy-paste your examples and they don’t work.</p>

</div>
<p>To address the root cause: If you feel the urge to add a prelude because your crate requires importing many modules to be usable, consider whether your public API is too large. Try reducing the number of modules and types by refactoring your public API. This way, you won’t need to hide imports in the first place.</p>
<h3 id="reducing-boilerplate"><a class="zola-anchor" href="#reducing-boilerplate" aria-label="Anchor link for: reducing-boilerplate">Reducing boilerplate</a></h3>
<p>Another common argument for preludes is that they reduce friction when importing types.</p>
<p>I don’t think that’s true anymore. Editor support for Rust has made great strides in the last years. Nowadays, your editor will just auto-import the type for you. (Largely thanks to <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://rust-analyzer.github.io/">Rust Analyzer</a> and <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://www.jetbrains.com/rust/">Rust Rover</a>). Problem solved! <sup class="footnote-reference" id="fr-editor-1"><a href="#fn-editor">2</a></sup></p>
<h3 id="trait-only-preludes"><a class="zola-anchor" href="#trait-only-preludes" aria-label="Anchor link for: trait-only-preludes">Trait-only preludes</a></h3>
<p>Preludes which only bring traits into scope might be acceptable.
This trick is sometimes used in combination with extension traits, which add extra functionality to common types. <code>rayon</code> does that, for example, and it’s quite magical if you can suddenly parallelize an iterator by just swapping <code>iter</code> with <code>par_iter</code>.</p>
<p>From their documentation:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">rayon<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">prelude<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-keyword z-operator z-arithmetic z-rust">*</span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">sum_of_squares</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span><span class="z-variable z-parameter z-rust">input</span><span class="z-punctuation z-separator z-rust">:</span> <span class="z-keyword z-operator z-rust">&amp;</span>[<span class="z-storage z-type z-rust">i32</span>]</span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">i32</span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    input<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">par_iter</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> &lt;-- just change that!
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">         <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">map</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">|</span></span></span><span class="z-meta z-function z-closure z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-keyword z-operator z-rust">&amp;</span><span class="z-variable z-parameter z-rust">i</span><span class="z-punctuation z-section z-parameters z-end z-rust">|</span></span> </span><span class="z-meta z-function z-closure z-rust">i <span class="z-keyword z-operator z-arithmetic z-rust">*</span> i</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">         <span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">sum</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<p>I think that’s a solid use case for a prelude, but I’ve never had such a clear-cut case in my own libraries.</p>
<h3 id="flexibility-for-library-authors"><a class="zola-anchor" href="#flexibility-for-library-authors" aria-label="Anchor link for: flexibility-for-library-authors">Flexibility For Library Authors</a></h3>
<p>Preludes can let library authors refactor their code without causing unnecessary churn for users:
If you often reorganize your internal structure, a prelude can provide a stable public API for common types.
The Bevy game engine uses this pattern, for example.</p>
<p>But hold on! This doesn’t mean the internal logic stays the same, and a prelude doesn’t guarantee API stability either.
These hidden changes might cause subtle bugs (e.g., when the prelude contains extension traits) which are hard to pin down.</p>
<p>Ask yourself: why does my public API change so much? There seems to be a deeper-rooted problem here.
For example, you might have leaked internal details into your public API, which you now want to change.</p>
<p>One way to provide stability without a prelude is to embrace semantic versioning. Before 1.0, you’re free to change your API frequently, with users expecting some churn. Once you’re happy with the API, switch to 1.0 and promise to maintain backwards compatibility. This approach gives you the flexibility of early prototyping paired with the stability guarantees of more mature libraries.</p>
<h3 id="sane-defaults-out-of-the-box"><a class="zola-anchor" href="#sane-defaults-out-of-the-box" aria-label="Anchor link for: sane-defaults-out-of-the-box">Sane Defaults Out of the Box</a></h3>
<p>For complex libraries, a well-designed prelude can improve clarity by curating important types. This seems appealing in security-sensitive domains to prevent misuse of incorrect types.</p>
<p>For example, a crypto library might provide a prelude with only the most secure algorithms. This way, users are guided towards secure defaults without needing to understand the intricacies of each algorithm.</p>
<p>That’s a valid argument, but I’d argue that it’s a slippery slope. First off, switching an algorithm is still a breaking change and it might still require changes in user code. Second, a prelude is no substitute for good documentation, examples, and a “Getting Started” guide.</p>
<p>Consider using Rust’s <code>#[deprecated]</code> attribute to phase out old behavior. This way, users get time to adapt to the new API.
Leverage Rust’s type system: Use newtypes, <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://predr.ag/blog/definitive-guide-to-sealed-traits-in-rust/">sealed traits</a>, and visibility modifiers (like <code>pub(crate)</code>) to guide users towards correct usage without relying on a prelude.</p>
<p>My rule of thumb here is to avoid hiding complexity behind a prelude and err on the side of explicitness.</p>
<h2 id="common-arguments-for-glob-imports"><a class="zola-anchor" href="#common-arguments-for-glob-imports" aria-label="Anchor link for: common-arguments-for-glob-imports">Common Arguments for Glob Imports</a></h2>
<p>Now that we’ve covered preludes, let’s look at some common arguments for why people use glob imports
and why you should be careful.</p>
<h3 id="preludes-are-convenient-for-beginners"><a class="zola-anchor" href="#preludes-are-convenient-for-beginners" aria-label="Anchor link for: preludes-are-convenient-for-beginners">Preludes are convenient for beginners</a></h3>
<p>Some people argue that preludes are beginner-friendly.
The argument goes that beginners don’t have to worry about importing types and can focus on learning the core concepts of a library.</p>
<p>As we will see, this can backfire quickly.</p>
<p>Here’s the catch: when you use glob imports, you’re opening yourself up to potential build breaks from minor version updates.
Adding new public items is considered a minor change according to <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://semver.org">semantic versioning</a> rules. That means when a crate bumps its version from, say, 1.2.0 to 1.3.0, it’s allowed to add new public items without breaking backwards compatibility.</p>
<p>Now, picture this scenario: You’re using a crate with a glob import, bringing all its public items into scope. You update the crate to the latest minor version, and suddenly your code doesn’t compile anymore. Ouch.</p>
<p>Well, that new minor version might have added a new public item that conflicts with a name in your code.</p>
<p>Here’s a quick example to illustrate:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> In your code you update some_crate from 1.2.0 to 1.3.0
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> In 1.3.0, some_crate added a new public item called Ferris.
</span></span><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">some_crate<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-keyword z-operator z-arithmetic z-rust">*</span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> In your own code, you have a struct called Ferris
</span></span><span class="z-source z-rust"><span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> Now you have a naming conflict, and your code won&#39;t compile!
</span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-modifier z-rust">pub</span> <span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Ferris</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre>
<p>The crate author didn’t break any promises – adding new public items is allowed in minor versions. But because of the glob import, what should have been a harmless update turned into a breaking change for your codebase and a minor headache for you.</p>
<p>Explicit imports protect you from these unexpected conflicts and make your code more resilient to changes in your dependencies.</p>
<h3 id="glob-imports-in-tests"><a class="zola-anchor" href="#glob-imports-in-tests" aria-label="Anchor link for: glob-imports-in-tests">Glob imports in tests</a></h3>
<p>It’s common to see <code>use super::*;</code> in tests to bring all functions from the parent module into scope. This can be a helpful mechanism to reduce boilerplate.
That’s the only exception I can think of where glob imports are acceptable.</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">foo</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> <span class="z-meta z-function z-return-type z-rust"><span class="z-punctuation z-separator z-rust">-&gt;</span> <span class="z-storage z-type z-rust">i32</span></span> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    <span class="z-constant z-numeric z-integer z-decimal z-rust">42</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-storage z-type z-module z-rust">mod</span> <span class="z-entity z-name z-module z-rust">tests</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust"><span class="z-keyword z-other z-rust">super</span><span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-keyword z-operator z-arithmetic z-rust">*</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust">    
</span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">test</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">test_something</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">        <span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-support z-function z-rust">foo</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-decimal z-rust">42</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">    </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-module z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre>
<h2 id="conclusion"><a class="zola-anchor" href="#conclusion" aria-label="Anchor link for: conclusion">Conclusion</a></h2>
<p>In your own code, avoid preludes and, by extension, glob imports.</p>
<p>Here are the main disadvantages:</p>
<ul>
<li>Makes it harder to know where types and functions come from</li>
<li>Can lead to naming conflicts, especially in larger codebases and when using multiple crates</li>
<li>Complicates security audits because it’s hard to see where code came from</li>
<li>May hide module hierarchy and structure, which is useful if you want to learn how a crate is designed</li>
<li>Can make IDE name resolution less reliable: if you have a name conflict, the IDE might not know which one you mean or might not be able to find the definition</li>
<li>Hides imports in documentation examples, making it harder to understand</li>
</ul>
<p>As you can see, the list of downsides is long. The only upside is that it saves a few keystrokes when writing code, which isn’t worth it in the long run.</p>
<p><strong>Pro tips:</strong></p>
<ul>
<li>Enable the <a class="external-link" rel="noopener noreferrer" target="_blank" href="https://rust-lang.github.io/rust-clippy/master/index.html#/wildcard_imports">clippy lint for wildcard imports</a> to catch glob imports in your code.</li>
<li>If you really want to create a prelude, at least use it for traits and macros only, not for types. Extending behavior of existing types (like adding a <code>par_iter</code> method to iterators with Rayon) is an acceptable use case for preludes if used in moderation. To avoid naming conflicts, consider using a unique prefix for extension traits like <code>CrateNameHashmapExt</code> instead of <code>HashMapExt</code>.</li>
<li>If you depend on a crate which has a prelude, consider not using it and instead importing the types you need explicitly. This way, you can avoid conflicts down the road and make it easier to see where a type comes from.</li>
</ul>
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn-1">
<p>A glob import (also called a wildcard import) is an import that brings all items of a module into scope. For example, <code>use std::collections::HashMap;</code> vs <code>use std::collections::*;</code>. <a href="#fr-1-1">↩</a></p>
</li>
<li id="fn-editor">
<p>I should mention that many modern editors can often show you the fully qualified path of a type, even when it’s imported via a prelude. This does away with some of the clarity concerns associated with preludes. <a href="#fr-editor-1">↩</a></p>
</li>
</ol>
</section>

    </div>
  </div>

  <div class="article-footer">
     
    

    <div class="social">
      <div class="share-icons"><a
  href="https://mastodonshare.com/?text=https:&#x2F;&#x2F;corrode.dev&#x2F;blog&#x2F;dont-use-preludes-and-globs&#x2F;+%0A%23rust"
  title="Share on Mastodon"
  target="_blank"
>
  <svg
    width="32px"
    height="32px"
    viewBox="0 0 512 512"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M480 174c0-105-68-135-68-135-35-16-94-22-155-23h-2c-61 1-120 7-155 23 0 0-68 30-68 135v82c3 102 19 202 113 227 44 12 81 14 111 13 55-3 85-20 85-20l-2-39s-39 12-82 10c-44-1-89-4-96-57a108 108 0 0 1-1-15 559 559 0 0 0 96 13c33 1 64-2 95-6 60-7 113-44 119-78 11-54 10-130 10-130Zm-81 134h-50V185c0-25-10-39-32-39-24 0-36 16-36 47v67h-50v-67c0-31-12-47-36-47-22 0-32 14-32 39v123h-50V182q0-39 19-62c14-15 32-23 54-23 25 0 45 10 58 30l12 21 12-21c13-20 33-30 58-30 22 0 40 8 54 23q20 23 19 62Z"
    ></path>
  </svg>
</a>
<a
  href="https://reddit.com/r/rust/submit?url=https:&#x2F;&#x2F;corrode.dev&#x2F;blog&#x2F;dont-use-preludes-and-globs&#x2F;&title=Don&#x27;t Use Preludes And Globs"
  onclick="window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;"
  title="Share on Reddit"
  rel="noopener"
  title="Share on Reddit"
>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
    <path
      d="M6.24 9.6c-.158 0-.313-.0469-.444-.135s-.234-.213-.295-.359c-.0606-.146-.0764-.307-.0455-.462.0309-.155.107-.298.219-.41s.254-.188.41-.219c.155-.0309.316-.0151.462.0455.146.0605.271.163.359.295.0879.132.135.286.135.444 0 .105-.0207.209-.0609.306-.0402.0971-.0991.185-.173.26s-.162.133-.26.173c-.097.0402-.201.0609-.306.0609zM16 8c0 1.58-.469 3.13-1.35 4.44-.879 1.32-2.13 2.34-3.59 2.95-1.46.606-3.07.764-4.62.455-1.55-.309-2.98-1.07-4.1-2.19-1.12-1.12-1.88-2.54-2.19-4.1-.309-1.55-.15-3.16.455-4.62.606-1.46 1.63-2.71 2.95-3.59s2.86-1.35 4.44-1.35c2.12 0 4.16.843 5.66 2.34 1.5 1.5 2.34 3.54 2.34 5.66zm-4.27-1.33c-.276.0162-.536.134-.73.33-.822-.544-1.78-.839-2.77-.85l.56-2.53 1.79.4c-.0013.105.0181.208.0572.305.0392.097.0971.185.171.26s.161.134.258.174c.0965.0403.2.0611.305.0611.213-.00263.417-.0891.566-.241.15-.152.234-.356.234-.569.006-.183-.0517-.362-.163-.507-.112-.145-.27-.247-.448-.288s-.365-.0195-.529.0618c-.164.0812-.294.217-.37.384l-2-.44c-.0476-.00913-.0969.00027-.138.0263s-.0703.0667-.0822.114l-.62 2.79c-.985.0141-1.95.309-2.77.85-.108-.112-.24-.199-.385-.254s-.301-.0793-.456-.0687c-.155.0105-.306.0547-.443.13-.136.0749-.255.179-.347.304-.0922.125-.156.269-.187.422s-.028.31.00821.461.105.293.202.415.219.222.358.292c-.0153.166-.0153.334 0 .5 0 1.69 1.91 3.07 4.26 3.07 2.35 0 4.26-1.38 4.26-3.07.0004-.172-.0198-.343-.06-.51.202-.114.362-.292.454-.505.0926-.213.113-.45.0592-.676-.0542-.226-.18-.428-.36-.576-.179-.148-.402-.233-.634-.244zm-2.22 3.75c-.449.282-.969.432-1.5.432s-1.05-.15-1.5-.432c-.0369-.0337-.085-.0524-.135-.0524s-.0981.0187-.135.0524c-.0194.0178-.0349.0394-.0455.0635s-.016.0502-.016.0765.0054.0524.016.0765.0261.0457.0455.0635c.525.356 1.15.547 1.78.547s1.25-.19 1.78-.547c.0194-.0178.0349-.0394.0455-.0635s.0161-.0502.0161-.0765-.0055-.0524-.0161-.0765-.0261-.0457-.0455-.0635c-.0187-.0197-.0412-.0353-.0661-.046s-.0518-.0163-.0789-.0163-.054.0056-.0789.0163-.0474.0263-.0661.046zM9.76 8c-.158 0-.313.0469-.444.135-.132.0879-.234.213-.295.359-.0605.146-.0764.307-.0455.462.0308.155.107.298.219.41s.254.188.41.219c.155.0309.316.0151.462-.0455.146-.0605.271-.163.359-.295.0879-.132.135-.286.135-.444 0-.212-.0843-.416-.234-.566s-.353-.234-.566-.234z"
    />
  </svg>
</a>

<a
  href="https://news.ycombinator.com/submitlink?u=https:&#x2F;&#x2F;corrode.dev&#x2F;blog&#x2F;dont-use-preludes-and-globs&#x2F;&t=Don&#x27;t Use Preludes And Globs"
  target="_blank"
  title="Share on Hacker News"
>
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
    <path
      d="M32 32v448h448V32Zm249.67 250.83v84H235v-84l-77-140h55l46.32 97.54 44.33-97.54h52.73Z"
    />
  </svg>
</a>

<a href="/rss.xml" target="_blank" title="Subscribe to RSS feed">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    fill-rule="evenodd"
    clip-rule="evenodd"
    image-rendering="optimizeQuality"
    shape-rendering="geometricPrecision"
    text-rendering="geometricPrecision"
    viewBox="0 0 640 640"
  >
    <path
      d="M116 449c-40.8 0-73.9 33.2-73.9 73.7 0 40.7 33.1 73.6 73.9 73.6 40.9 0 74-32.9 74-73.6 0-40.5-33.1-73.7-74-73.7zM42.2 231v106c69.3 0 134 27.1 183 76.2 49 48.9 76 114 76 184h107c0-202-164-366-366-366v-.0312zm.133-189v106c247 0 448 201 448 449l107 .0104c0-306-249-555-555-555z"
    />
  </svg>
</a>
</div>
      <div class="editor-credits"><article class="metadata">
    <div class="published">
        <time datetime="2024-07-29">
            Published: 2024-07-29
        </time>
    </div><div class="updated">
        <time datetime="2024-08-07">
            Last updated: 2024-08-07
        </time>
    </div>
    
    
    <div>
        <a href="https://github.com/corrode/corrode.github.io/commits/master/content/&#x2F;blog&#x2F;dont-use-preludes-and-globs&#x2F;">Full git revision history</a>
    </div>

    <div class="authors">
        <span>Author:</span>
        <a href="/services">Matthias Endler</a>
    </div>

    <div class="editor">
        <span>Editor:</span>
        <a
            href="https://hachyderm.io/@m3t0r"
            target="_blank"
            rel="noopener noreferrer"
        >
            Simon Brüggen
        </a>
    </div>

    
    <div class="reviewers">
        <span>Reviewers:</span>
        
                <a href="https:&#x2F;&#x2F;www.brettwitty.net" target="_blank" rel="noopener noreferrer">Brett Witty</a>
                    and
                <a href="https:&#x2F;&#x2F;weinzierlweb.com&#x2F;ludwig" target="_blank" rel="noopener noreferrer">Ludwig Weinzierl</a>
    </div>
     
</article>
</div>
    </div>

    <div class="newsletter-callout">
  <h2>Idiomatic Rust content. Straight to your inbox.</h2>
  <p>
    I regularly write new articles on idiomatic Rust. If you want to be notified
    when I publish them, you should sign up to my newsletter here. No spam.
    Unsubscribe at any time.
  </p>
  <div id="subscription-section">
    <form
      id="newsletter-form"
      action="https://corrode-newsletter.fly.dev/subscribe"
      method="post"
    >
      <input
        type="email"
        name="email"
        placeholder="mail@example.com"
        required
        id="tlemail"
      />
      <div style="display: none">
        <input type="text" name="hpfield" value="" />
      </div>
      <button type="submit" id="submit-btn">
        <span id="button-text">Subscribe</span>
        <div id="spinner" style="display: none">
          <div
            style="
              display: inline-block;
              width: 16px;
              height: 16px;
              border: 2px solid rgba(255, 255, 255, 0.3);
              border-top: 2px solid white;
              border-radius: 50%;
              animation: spin 1s linear infinite;
              margin-right: 8px;
            "
          ></div>
          Subscribing...
        </div>
      </button>
    </form>
  </div>
</div>

<style>
  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
</style>

<script>
  document
    .getElementById("newsletter-form")
    .addEventListener("submit", function (e) {
      e.preventDefault(); // Prevent the default form submission

      // Show spinner and hide button text
      document.getElementById("button-text").style.display = "none";
      document.getElementById("spinner").style.display = "inline-block";
      document.getElementById("submit-btn").disabled = true;

      const formData = new FormData(this);
      fetch("https://corrode-newsletter.fly.dev/subscribe", {
        method: "POST",
        body: new URLSearchParams(formData),
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
      })
        .then((response) => {
          if (response.ok) {
            document.getElementById("subscription-section").innerHTML =
              "<p><b>Thank you for subscribing!</b></p>";
          } else {
            throw new Error("Server responded with an error"); // Forces catch block execution
          }
        })
        .catch((error) => {
          console.error("Error:", error);
          document.getElementById("subscription-section").innerHTML =
            "<p><b>There was a problem with your subscription. Please try again later.</b></p>";
        });
    });
</script>


    <div class="topbox">&uarr; <a href="#top">Back to top</a></div>
  </div>
</article>

        </main>
    
    </div>

    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h3>Company</h3>
                <ul class="footer-links">
                    <li><a href="/services/">Consulting</a></li>
                    <li><a href="/blog/why-rust/">Why Rust?</a></li>
                    <li><a href="/quote/">Business Inquiries</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Resources</h3>
                <ul class="footer-links">
                    <li><a href="/blog/">Blog</a></li>
                    <li><a href="/podcast">Podcast</a></li>
                    <li><a href="/learn/case-studies/">Case Studies</a></li>
                    <li><a href="/blog/rust-conferences-2025/">Conferences</a></li>
                    <li><a href="/blog/idiomatic-rust-resources/">Learning Resources</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Migration Guides</h3>
                <ul class="footer-links">
                    <li><a href="/learn/migration-guides/python-to-rust/">Python</a></li>
                    <li><a href="/learn/migration-guides/typescript-to-rust/">TypeScript</a></li>
                    <li><a href="/learn/migration-guides/java-to-rust/">Java</a></li>
                    <li><a href="/learn/migration-guides/scala-to-rust/">Scala</a></li>
                    <li><a href="/learn/migration-guides/cpp-to-rust/">C++</a></li>
                </ul>
            </div>

            <div class="footer-column">
                <h3>Connect</h3>
                <ul class="footer-links">
                    <li><a href="https://github.com/corrode">GitHub</a></li>
                    <li><a href="https://www.linkedin.com/company/corrode/">LinkedIn</a></li>
                    <li><a href="/legal/">Legal Notice</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script>
        function getPreferredColorScheme() {
            let systemScheme = 'light';
            if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                systemScheme = 'dark';
            }
            let chosenScheme = systemScheme;

            if (localStorage.getItem("scheme")) {
                chosenScheme = localStorage.getItem("scheme");
            }

            if (systemScheme === chosenScheme) {
                localStorage.removeItem("scheme");
            }

            return chosenScheme;
        }

        function savePreferredColorScheme(scheme) {
            let systemScheme = 'light';

            if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                systemScheme = 'dark';
            }

            if (systemScheme === scheme) {
                localStorage.removeItem("scheme");
            }
            else {
                localStorage.setItem("scheme", scheme);
            }
        }

        function toggleColorScheme() {
            let newScheme = "light";
            let scheme = getPreferredColorScheme();
            if (scheme === "light") {
                newScheme = "dark";
            }

            applyPreferredColorScheme(newScheme);
            savePreferredColorScheme(newScheme);
        }

        function applyPreferredColorScheme(scheme) {
            for (var s = 0; s < document.styleSheets.length; s++) {
                try {
                    var rules = document.styleSheets[s].cssRules;
                    for (var i = 0; i < rules.length; i++) {
                        var rule = rules[i];
                        if (rule && rule.media && rule.media.mediaText.includes("prefers-color-scheme")) {
                            switch (scheme) {
                                case "light":
                                    rule.media.appendMedium("original-prefers-color-scheme");
                                    if (rule.media.mediaText.includes("light")) rule.media.deleteMedium("(prefers-color-scheme: light)");
                                    if (rule.media.mediaText.includes("dark")) rule.media.deleteMedium("(prefers-color-scheme: dark)");
                                    break;
                                case "dark":
                                    rule.media.appendMedium("(prefers-color-scheme: light)");
                                    rule.media.appendMedium("(prefers-color-scheme: dark)");
                                    if (rule.media.mediaText.includes("original")) rule.media.deleteMedium("original-prefers-color-scheme");
                                    break;
                                default:
                                    rule.media.appendMedium("(prefers-color-scheme: dark)");
                                    if (rule.media.mediaText.includes("light")) rule.media.deleteMedium("(prefers-color-scheme: light)");
                                    if (rule.media.mediaText.includes("original")) rule.media.deleteMedium("original-prefers-color-scheme");
                                    break;
                            }
                        }
                    }
                } catch (e) {
                    // Ignore third-party stylesheets
                }
            }

            if (scheme === "dark") {
                document.getElementById("icon-moon").style.display = 'inline';
                document.getElementById("icon-sun").style.display = 'none';
            } else {
                document.getElementById("icon-sun").style.display = 'inline';
                document.getElementById("icon-moon").style.display = 'none';
            }
        }

        applyPreferredColorScheme(getPreferredColorScheme());
    </script>
</body>
</html>
