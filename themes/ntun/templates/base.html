<!DOCTYPE html>
<html lang="{{lang}}">

{%- if not page %}
{%- set social_description = "Rust consulting and development based in Germany that puts people first" %}
{%- elif page.extra.excerpt %}
{%- set social_description = page.extra.excerpt %}
{%- elif page.summary %}
{%- set social_description = page.summary %}
{%- else %}
{%- set social_description = page.content | truncate(length=250) %}
{%- endif %}


<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  {% if page and page.title %}
  <title>{{ page.title }} | {{ config.extra.author }}</title>
  {% else %}
  <title>{{ config.extra.author }}</title>
  {% endif %}
  <meta name="author" content="{{ config.extra.author }}">
  <meta name="description" content="{{ social_description | striptags | safe }}"">

  <!-- Open Graph tags -->
  <meta property="og:title" content="{{ config.extra.author }}">
  <meta property="og:description" content="{{ social_description | striptags | safe }}>
  <meta property="og:image" content="{{ config.base_url ~ '/social/social.png' }}">
  <meta property="og:url" content="{{ config.base_url }}">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="{{ config.extra.author }}">

  <!-- Twitter Card tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ config.extra.author }}">
  <meta name="twitter:description" content="{{ social_description | striptags | safe }}>
  <meta name="twitter:image" content="{{ config.base_url ~ '/social/social.png' }}">

  <link rel="stylesheet" href="{{ get_url(path='style.css') }}">
  <link rel="stylesheet" type="text/css" href="/syntax-theme-dark.css" media="(prefers-color-scheme: dark)" />
  <link rel="stylesheet" type="text/css" href="/syntax-theme-light.css" media="(prefers-color-scheme: light)" />

  <link rel="me" href="https://mastodon.social/@mre">
  <link rel="alternate" type="application/rss+xml" title="Corrode RSS feed" href="/rss.xml">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
  <script type="module" src="{{ config.base_url ~ '/js/oxitraffic.js' }}" defer></script>
</head>

<body>
  <div class="app">
    <nav class="nav">
      <a {% if current_path and current_path == "/" %} class="nav-item active" {% else %} class="nav-item" {% endif %}
          {% if lang == "en" %} href="{{ config.base_url ~ '/' }}" {% else %} href="{{ config.base_url ~ '/' ~ lang}}" {% endif %}
      >
        {% set logo = load_data(path="static/corrode.svg") %}
        {{ logo| safe }}
      </a>
      <div class="nav-right">
        <a href="javascript:toggleColorScheme();">
          <span id="icon-moon">
            {% set sun = load_data(path="static/icons/moon.svg") %}
            {{ sun| safe }}
          </span>
          <span id="icon-sun">
            {% set moon = load_data(path="static/icons/sun.svg") %}
            {{ moon| safe }}
          </span>
        </a>
        <a {% if current_path and current_path == "/" %}class="nav-item active"{% else %}class="nav-item"{% endif %}
            href="{{ config.base_url ~ '/' }}"><span>Home</span>
        </a>
        <a {% if current_path and current_path is containing("/about") %}class="nav-item active"{% else %}class="nav-item"{% endif %}
            {% if lang == "en" %} href="{{ config.base_url ~ '/about' }}" {% else %} href="{{ config.base_url ~ '/' ~ lang ~ '/about'}}" {% endif %}
        >
            <span>About</span>
        </a>
        <a {% if current_path and current_path is containing("/blog") %}class="nav-item active"{% else %}class="nav-item"{% endif %}
            {% if lang == "en" %} href="{{ config.base_url ~ '/blog' }}" {% else %} href="{{ config.base_url ~ '/' ~ lang ~ '/blog'}}" {% endif %}
        >
            <span>Blog</span>
        </a>
        <a {% if  current_path and current_path is containing("/legal") %}class="nav-item active"{% else %}class="nav-item"{% endif %}
            {% if lang == "en" %} href="{{ config.base_url ~ '/legal' }}" {% else %} href="{{ config.base_url ~ '/' ~ lang ~ '/legal'}}" {% endif %}
        >
            <span>Legal</span>
        </a>
        <a class="nav-item button"
            {% if lang == "en" %} href="{{ config.base_url ~ '/quote' }}" {% else %} href="{{ config.base_url ~ '/' ~ job ~ '/quote'}}" {% endif %}
        >
            <span>Get a Quote</span>
        </a>
      </div>
    </nav>
    <main class="container">
      {% block content %} {% endblock %}
    </main>
    <footer class="footer">
      {% block footer %}
        <div>
          <span class="copyright">Â©</span>&nbsp;2023 corrode &mdash; D&uuml;sseldorf, Germany
        </div>
      {% endblock footer %}
    </footer>
  </div>
  <script>
    function getPreferredColorScheme(){
      let systemScheme = 'light';
      if(window.matchMedia('(prefers-color-scheme: dark)').matches){
        systemScheme = 'dark';
      }
      let chosenScheme = systemScheme;
  
      if(localStorage.getItem("scheme")){
        chosenScheme = localStorage.getItem("scheme");
      }
  
      if(systemScheme === chosenScheme){
        localStorage.removeItem("scheme");
      }
  
      return chosenScheme;
    }
  
    function savePreferredColorScheme(scheme){
      let systemScheme = 'light';
  
      if(window.matchMedia('(prefers-color-scheme: dark)').matches){
        systemScheme = 'dark';
      }
  
      if(systemScheme === scheme){
        localStorage.removeItem("scheme");
      }
      else {
        localStorage.setItem("scheme", scheme);
      }
    }
  
    function toggleColorScheme(){
      let newScheme = "light";
      let scheme = getPreferredColorScheme();
      if (scheme === "light"){
        newScheme = "dark";
      }
  
      applyPreferredColorScheme(newScheme);
      savePreferredColorScheme(newScheme);
    }
  
    function applyPreferredColorScheme(scheme) {
      for (var s = 0; s < document.styleSheets.length; s++) {
        try {
          var rules = document.styleSheets[s].cssRules;
          for (var i = 0; i < rules.length; i++) {
            var rule = rules[i];
            if (rule && rule.media && rule.media.mediaText.includes("prefers-color-scheme")) {
              switch (scheme) {
                case "light":
                  rule.media.appendMedium("original-prefers-color-scheme");
                  if (rule.media.mediaText.includes("light")) rule.media.deleteMedium("(prefers-color-scheme: light)");
                  if (rule.media.mediaText.includes("dark")) rule.media.deleteMedium("(prefers-color-scheme: dark)");
                  break;
                case "dark":
                  rule.media.appendMedium("(prefers-color-scheme: light)");
                  rule.media.appendMedium("(prefers-color-scheme: dark)");
                  if (rule.media.mediaText.includes("original")) rule.media.deleteMedium("original-prefers-color-scheme");
                  break;
                default:
                  rule.media.appendMedium("(prefers-color-scheme: dark)");
                  if (rule.media.mediaText.includes("light")) rule.media.deleteMedium("(prefers-color-scheme: light)");
                  if (rule.media.mediaText.includes("original")) rule.media.deleteMedium("original-prefers-color-scheme");
                  break;
              }
            }
          }
        } catch (e) {
          // Ignore third-party stylesheets
        }
      }
  
      if (scheme === "dark") {
        document.getElementById("icon-moon").style.display = 'inline';
        document.getElementById("icon-sun").style.display = 'none';
      } else {
        document.getElementById("icon-sun").style.display = 'inline';
        document.getElementById("icon-moon").style.display = 'none';
      }
    }
  
    applyPreferredColorScheme(getPreferredColorScheme());
  </script>
</body>
</html>
